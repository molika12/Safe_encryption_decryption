<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SecureShare - Secure Login</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: 'Inter', sans-serif; background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%); min-height: 100vh; overflow-x: hidden; position: relative; color: #f8fafc; }
.particles { position: absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:1; }
.particle { position: absolute; background: rgba(59, 130, 246, 0.1); border-radius:50%; animation: float 6s ease-in-out infinite; }
@keyframes float { 0%,100% { transform:translateY(0) rotate(0deg); opacity:0.7; } 50% { transform:translateY(-20px) rotate(180deg); opacity:0.3; } }
.header { position: relative; z-index: 10; padding: 40px 20px 20px; text-align: center; }
.logo-container { display: flex; align-items: center; justify-content: center; margin-bottom: 15px; }
.logo-icon { background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%); width: 50px; height: 50px; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 15px; box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4); }
.logo-icon i { color: white; font-size: 24px; }
.logo-text { font-size: 2.8rem; font-weight: 700; background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.tagline { color: rgba(255,255,255,0.7); font-size: 1.2rem; font-weight: 300; max-width: 600px; margin: 0 auto; line-height: 1.5; }
.container { position:relative; z-index:10; display:flex; justify-content:center; align-items:center; min-height:70vh; padding:20px; }
.login-card { display:flex; width:1200px; max-width:95%; background: rgba(15, 23, 42, 0.7); backdrop-filter: blur(20px); border-radius:24px; overflow:hidden; box-shadow: 0 25px 60px rgba(0,0,0,0.25), 0 0 0 1px rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); animation: slideUp 0.8s ease-out; }
@keyframes slideUp { from { opacity:0; transform:translateY(30px); } to { opacity:1; transform:translateY(0); } }
.hero-section { flex:1; background: linear-gradient(135deg, #1e293b 0%, #334155 100%); display:flex; flex-direction:column; justify-content:center; align-items:center; padding:60px 40px; text-align:center; position:relative; overflow:hidden; }
.hero-section::before { content:''; position:absolute; top:-50%; left:-50%; width:200%; height:200%; background: radial-gradient(circle, rgba(255,255,255,0.03) 1px, transparent 1px); background-size:50px 50px; animation: drift 20s linear infinite; }
@keyframes drift { 0% { transform:translate(0,0); } 100% { transform:translate(-50px,-50px); } }
.hero-content { position:relative; z-index:2; max-width: 500px; }
.hero-title { font-size:2.8rem; font-weight:700; color:white; margin-bottom:20px; line-height:1.2; text-shadow:0 2px 20px rgba(0,0,0,0.3); }
.hero-subtitle { font-size:1.2rem; color: rgba(255,255,255,0.8); margin-bottom:30px; line-height:1.6; font-weight:300; }
.feature-list { list-style: none; text-align: left; margin-top: 30px; }
.feature-list li { color: rgba(255,255,255,0.9); margin-bottom: 15px; display: flex; align-items: center; font-weight: 400; }
.feature-list li i { margin-right: 12px; color: #3b82f6; font-size: 1.2rem; }
.form-section { flex:1; padding:60px 50px; display:flex; flex-direction:column; justify-content:center; background: rgba(30, 41, 59, 0.5); }
.form-header { text-align:center; margin-bottom:35px; }
.form-title { font-size:2.2rem; font-weight:600; color:#f8fafc; margin-bottom:10px; }
.form-subtitle { font-size:1rem; color:#94a3b8; font-weight:400; }
.role-toggle { display:flex; justify-content:center; margin-bottom:30px; background: rgba(15, 23, 42, 0.7); border-radius:12px; padding:4px; border: 1px solid rgba(255,255,255,0.1); }
.role-toggle button { flex:1; border:none; padding:14px 24px; border-radius:10px; background:transparent; cursor:pointer; font-weight:600; font-size:0.95rem; position:relative; overflow:hidden; color: #94a3b8; display: flex; align-items: center; justify-content: center; }
.role-toggle button i { margin-right: 8px; font-size: 1.1rem; }
.role-toggle button::before { content:''; position:absolute; top:0; left:-100%; width:100%; height:100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent); transition:left 0.5s; }
.role-toggle button:hover::before { left:100%; }
.role-toggle button.active { background: linear-gradient(135deg, #3b82f6, #8b5cf6); color:white; box-shadow:0 4px 15px rgba(59, 130, 246, 0.3); transform:translateY(-1px); }
.form-group { margin-bottom:24px; position:relative; }
.form-group label { display: block; font-size: 0.9rem; font-weight: 500; margin-bottom: 8px; color: #e2e8f0; }
.form-group input { width:100%; padding:16px 20px; font-size:1rem; border:2px solid #334155; border-radius:12px; outline:none; transition: all 0.3s; background: rgba(15, 23, 42, 0.5); font-family:'Inter',sans-serif; color: #f8fafc; }
.form-group input:focus { border-color:#3b82f6; box-shadow:0 0 0 4px rgba(59, 130, 246, 0.1); transform:translateY(-2px); background: rgba(15, 23, 42, 0.7); }
.form-group input::placeholder { color:#64748b; }
.password-container { position: relative; }
.toggle-password { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); background: none; border: none; color: #94a3b8; cursor: pointer; font-size: 1.1rem; }
.remember-forgot { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; font-size: 0.9rem; }
.remember-me { display: flex; align-items: center; }
.remember-me input { margin-right: 8px; }
.forgot-password { color: #3b82f6; text-decoration: none; transition: color 0.3s; }
.forgot-password:hover { color: #60a5fa; text-decoration: underline; }
.submit-btn { width:100%; padding:18px; border:none; border-radius:12px; background: linear-gradient(135deg, #3b82f6, #8b5cf6); color:white; font-weight:600; font-size:1.1rem; cursor:pointer; margin-top:10px; position:relative; overflow:hidden; transition: all 0.3s; display: flex; align-items: center; justify-content: center; gap: 10px; }
.submit-btn::before { content:''; position:absolute; top:0; left:-100%; width:100%; height:100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); transition:left 0.5s; }
.submit-btn:hover { transform:translateY(-2px); box-shadow:0 10px 25px rgba(59, 130, 246, 0.4); }
.submit-btn:hover::before { left:100%; }
.submit-btn:active { transform:translateY(0); }
#status { margin-top:20px; padding:12px; border-radius:8px; font-size:0.95rem; text-align:center; font-weight:500; transition: all 0.3s ease; min-height:20px; border: 1px solid transparent; }
.signup-link { text-align: center; margin-top: 25px; font-size: 0.95rem; color: #94a3b8; }
.signup-link a { color: #3b82f6; text-decoration: none; font-weight: 500; }
.signup-link a:hover { text-decoration: underline; }
.footer { position: relative; z-index: 10; text-align: center; padding: 30px 20px; color: rgba(255,255,255,0.6); font-size: 0.9rem; }
.footer-links { display: flex; justify-content: center; flex-wrap: wrap; margin-bottom: 15px; }
.footer-links a { color: rgba(255,255,255,0.7); text-decoration: none; margin: 0 15px; transition: color 0.3s; }
.footer-links a:hover { color: #3b82f6; }
@media(max-width: 1024px) { .login-card { flex-direction: column; margin: 20px; } .hero-section { padding: 50px 40px; } .hero-title { font-size: 2.5rem; } .form-section { padding: 50px 40px; } .form-title { font-size: 2rem; } }
@media(max-width: 768px){ .header { padding: 30px 20px 15px; } .logo-text { font-size: 2.2rem; } .tagline { font-size: 1.1rem; } .hero-section { padding:40px 30px; } .hero-title { font-size:2.2rem; } .form-section { padding:40px 30px; } .form-title { font-size:1.8rem; } .role-toggle { flex-direction: column; } .role-toggle button { margin-bottom: 8px; } }
@media(max-width: 480px){ .container { padding:10px; } .hero-section { padding:30px 20px; } .form-section { padding:30px 25px; } .remember-forgot { flex-direction: column; align-items: flex-start; gap: 10px; } .footer-links a { margin: 0 10px 10px; } }
</style>
</head>
<body>

<div class="particles">
  <div class="particle" style="width:20px;height:20px;top:10%;left:10%;animation-delay:0s;"></div>
  <div class="particle" style="width:15px;height:15px;top:20%;left:80%;animation-delay:1s;"></div>
  <div class="particle" style="width:25px;height:25px;top:60%;left:5%;animation-delay:2s;"></div>
  <div class="particle" style="width:18px;height:18px;top:80%;left:70%;animation-delay:3s;"></div>
  <div class="particle" style="width:22px;height:22px;top:30%;left:60%;animation-delay:4s;"></div>
</div>

<div class="header">
  <div class="logo-container">
    <div class="logo-icon"><i class="fas fa-shield-alt"></i></div>
    <div class="logo-text">SecureShare</div>
  </div>
  <p class="tagline">Secure file sharing with enterprise-grade encryption and advanced access controls</p>
</div>

<div class="container">
  <div class="login-card">
    <div class="hero-section">
      <div class="hero-content">
        <h1 class="hero-title">Welcome Back</h1>
        <p class="hero-subtitle">Access your SecureShare account to continue secure file sharing</p>
        <ul class="feature-list">
          <li><i class="fas fa-shield-check"></i> End-to-end encryption</li>
          <li><i class="fas fa-bolt"></i> Lightning-fast transfers</li>
          <li><i class="fas fa-users"></i> Team collaboration</li>
          <li><i class="fas fa-chart-line"></i> Advanced analytics</li>
        </ul>
      </div>
    </div>

    <div class="form-section">
      <div class="form-header">
        <h2 class="form-title">Account Login</h2>
        <p class="form-subtitle">Select your role and enter your credentials</p>
      </div>

      <div class="role-toggle">
        <button id="senderBtn" class="active"><i class="fas fa-upload"></i> File Sender</button>
        <button id="receiverBtn"><i class="fas fa-download"></i> File Receiver</button>
      </div>

      <form id="loginForm">
        <div class="form-group">
          <label for="email">Email Address</label>
          <input type="email" id="email" placeholder="Enter your email address" required>
        </div>
        
        <div class="form-group">
          <label for="password" id="passwordLabel">Password</label>
          <div class="password-container">
            <input type="password" id="password" placeholder="Enter your password" required>
            <button type="button" class="toggle-password" id="togglePassword">
              <i class="fas fa-eye"></i>
            </button>
          </div>
        </div>
        
        <div class="remember-forgot">
          <label class="remember-me"><input type="checkbox" id="rememberMe"> Remember me</label>
          <a href="#" class="forgot-password">Forgot password?</a>
        </div>
        
        <button type="submit" class="submit-btn"><i class="fas fa-sign-in-alt"></i> Login to SecureShare</button>
      </form>
      
      <div id="status"></div>
      
      <div class="signup-link">
        Don't have an account? <a href="signup.html">Sign up here</a>
      </div>
    </div>
  </div>
</div>

<div class="footer">
  <div class="footer-links">
    <a href="#">Privacy Policy</a>
    <a href="#">Terms of Service</a>
    <a href="#">Security</a>
    <a href="#">Support</a>
  </div>
  <div class="copyright">&copy; 2025 SecureShare Technologies. All rights reserved.</div>
</div>

<script>
let role='sender';
const senderBtn=document.getElementById('senderBtn');
const receiverBtn=document.getElementById('receiverBtn');
const status=document.getElementById('status');
const togglePassword = document.getElementById('togglePassword');
const passwordInput = document.getElementById('password');
const passwordLabel = document.getElementById('passwordLabel');

// Role toggle
senderBtn.addEventListener('click',()=>{ 
  role='sender'; 
  senderBtn.classList.add('active'); 
  receiverBtn.classList.remove('active'); 
  passwordInput.parentElement.parentElement.style.display = 'block';
  passwordLabel.innerText = 'Password';
  passwordInput.placeholder = 'Enter your password';
  passwordInput.type='password';
});

receiverBtn.addEventListener('click',()=>{ 
  role='receiver'; 
  receiverBtn.classList.add('active'); 
  senderBtn.classList.remove('active'); 
  passwordInput.parentElement.parentElement.style.display = 'block';
  passwordLabel.innerText = 'Sender ID';
  passwordInput.placeholder = 'Enter Sender ID';
  passwordInput.type='text';
});

// Toggle password visibility
togglePassword.addEventListener('click', ()=>{
  if(passwordInput.type==='password'){ passwordInput.type='text'; } 
  else { passwordInput.type='password'; }
});

// Form submit
document.getElementById('loginForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const email = document.getElementById('email').value;
  const passOrSenderId = document.getElementById('password').value;
  const btn = e.target.querySelector('.submit-btn');
  const originalText = btn.innerHTML;
  btn.innerHTML='<i class="fas fa-spinner fa-spin"></i> Logging in...'; 
  btn.disabled=true;

  status.innerHTML = '';
  status.style.backgroundColor = '';
  status.style.border = '';
  status.style.color = '';

  try {
    // This now matches the new /login route in server.js
    const bodyData = role === 'sender' 
      ? { role: 'sender', email: email, password: passOrSenderId } 
      : { role: 'receiver', email: email, senderId: passOrSenderId };

    const res = await fetch('http://localhost:5000/login', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify(bodyData)
    });
    const result = await res.json();

    if(result.success){
      localStorage.setItem('email', email);
      if(role==='sender'){ 
        localStorage.setItem('senderId', result.uniqueId); 
      }
      else { 
        localStorage.setItem('senderId', passOrSenderId); 
        // --- THIS IS THE CRITICAL FIX ---
        // Save the keys array to local storage for the receiver
        localStorage.setItem('receiverKeys', JSON.stringify(result.keys));
      }

      status.innerHTML='✅ Login successful! Redirecting...';
      status.style.color='#10b981';
      status.style.backgroundColor = 'rgba(16, 185, 129, 0.1)';
      status.style.border = '1px solid rgba(16, 185, 129, 0.3)';

      setTimeout(()=>{ 
        // Redirect to the new dashboard pages
        window.location.href=role==='sender'?'sender_dashboard.html':'receiver_dashboard.html'; 
      },1500);
    } else {
      status.innerHTML='❌ ' + result.message;
      status.style.color='#ef4444';
      status.style.backgroundColor = 'rgba(239, 68, 68, 0.1)';
      status.style.border = '1px solid rgba(239, 68, 68, 0.3)';
    }
  } catch(e){
    status.innerHTML='❌ Network error. Please check your connection.';
    status.style.color='#ef4444';
    status.style.backgroundColor = 'rgba(239, 68, 68, 0.1)';
    status.style.border = '1px solid rgba(239, 68, 68, 0.3)';
  } finally {
    btn.innerHTML=originalText; 
    btn.disabled=false;
  }
});
</script>

</body>
</html>